<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#202020"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="keywords" content="Spring,"><meta name="description" content="Spring远程调用-HttpInvokerProxyFactoryBean和HttpInvokerServiceExporter"><link rel="icon" type="image/x-icon" href="/logo.png"><title>Spring远程调用-HttpInvokerProxyFactoryBean和HttpInvokerServiceExporter [ 大新闻 ]</title><link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" href="/css/microb.css"></head><body><nav class="home-menu pure-menu pure-menu-horizontal pure-menu-fixed"><ul class="pure-menu-list float-r clearfix"><li class="pure-menu-item toc-menu"><a id="menu-main-post" class="pure-menu-link" href="javascript:;"><img class="menu-icon" src="/logo.png" alt="MENU"></a></li></ul><a class="pure-menu-heading" href="/"><h1 class="title">大新闻</h1></a></nav><div class="container" id="content-outer"><div class="inner" id="content-inner"><article class="post" id="post"><header class="post-header text-center"><h1 class="title">Spring远程调用-HttpInvokerProxyFactoryBean和HttpInvokerServiceExporter</h1><time class="time" datetime="2017-09-08T01:59:27.000Z">2017-09-08</time><hr></header><div class="post-content"><div class="note info"><p>Spring 远程调用HttpInvokerServiceExporter和HttpInvokerProxyFactoryBean的使用小计。</p></div><a id="more"></a><p>Spring 允许通过HTTP协议实现远程调用，提供了<code>HttpInvokerProxyFactoryBean</code>和 <code>HttpInvokerServiceExporter</code>。在服务端暴漏远程调用接口，在客户端生成一个代理对象，通过代理对象调用远程接口，使用方式比较简单直接。</p><h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><ol><li><p>定义远程接口和实现</p><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppService</span> </span>&#123;</div><div class="line">  <span class="comment">/// method</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppServiceImpl</span> <span class="keyword">implements</span> <span class="title">AppService</span> </span>&#123;</div><div class="line">  <span class="comment">/// method</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>声明<code>HttpInvokerServiceExporter</code> bean</p><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"remoteAppService"</span> <span class="attr">class</span>=<span class="string">"com.frame.rmote.RemoteServiceImpl"</span> /&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"appService"</span> <span class="attr">class</span>=<span class="string">"org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"service"</span> <span class="attr">ref</span>=<span class="string">"remoteAppService"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"serviceInterface"</span> <span class="attr">value</span>=<span class="string">"me.meiqiu.app.AppService"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>暴漏远程URL</p><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"simpleUrlRequestHandler"</span></span></div><div class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"alwaysUseFullPath"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"urlMap"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">map</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 远程调用的输出，注意向外暴露URL的安全性 --&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"/remote/app/service"</span> <span class="attr">value-ref</span>=<span class="string">"appService"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">map</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure></li></ol><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><p>创建HttpInvokerProxyFactoryBean对象(二选1)</p><p>a. 代码创建方式：</p><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 动态创建HttpInvokerProxyFactoryBean</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Created by meiqiu.me on 2017/9/1.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpInvokerProxyFactory</span>&lt;<span class="title">Client</span> <span class="keyword">extends</span> <span class="title">Object</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Client <span class="title">getProxy</span><span class="params">(String serviceUrl, Class serviceInterface)</span> </span>&#123;</div><div class="line">        HttpInvokerProxyFactoryBean factoryBean = <span class="keyword">new</span> HttpInvokerProxyFactoryBean();</div><div class="line">        factoryBean.setServiceUrl(serviceUrl);</div><div class="line">        factoryBean.setServiceInterface(serviceInterface);</div><div class="line">        factoryBean.afterPropertiesSet();</div><div class="line">        <span class="keyword">return</span> factoryBean.getObject();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*public static void main(String[] args) &#123;</span></div><div class="line"><span class="comment">        String serviceUrl = "http://meiqiu.me:8080/remote/app/service";</span></div><div class="line"><span class="comment">        AppService client = new HttpInvokerProxyFactory&lt;AppService&gt;().getProxy(md5ClientService, serviceUrl, AppService.class);</span></div><div class="line"><span class="comment">    &#125;*/</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>b. xml方式：</p><figure class="highlight xml"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"appServiceProxy"</span></span></div><div class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">"org.springframework.remoting.httpinvoker.HttpInvokerProxyFactoryBean"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"serviceUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;service.url&#125;/remote/app/service"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"serviceInterface"</span> <span class="attr">value</span>=<span class="string">"me.meiqiu.app.AppService"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>完。</p></div><div class="post-tags"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li></ul></div></article><div class="post-nav"><div class="post-nav-item post-nav-next"><a href="/2017/08/31/2017/docker-nodejs-mongodb-redis-nginx/" rel="next" title="docker部署nodejs+mongodb+redis+nginx"><span>〈 </span>docker部署nodejs+mongodb+redis+nginx</a></div><div class="post-nav-item post-nav-prev"><a href="/2017/10/30/2017/android-base64-nowrap-to-html-img/" rel="prev" title="Android使用base64(Base64.NO_WRAP)并显示到html.img标签中的正确方式">Android使用base64(Base64.NO_WRAP)并显示到html.img标签中的正确方式 <span>〉</span></a></div></div><div id="toc" class="toc-article"><strong class="toc-title">目录</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#服务端"><span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#客户端"><span class="toc-text">客户端</span></a></li></ol></div></div></div><footer class="footer text-center"><div id="bottom-inner"><a href="" target="_blank" class="footer-link">Hexo</a> <a href="" target="_blank" class="footer-link">Theme microb</a></div></footer><script>var titleTime,originTitle=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="[闷声发大财中...] "+originTitle,clearTimeout(titleTime)):(document.title="[+1s] "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))})</script><script>!function(n,e){!function(){var n=e.getElementById("menu-main-post");if(n){var t=e.getElementById("toc");t?n.onclick=function(){t&&("block"==t.style.display?t.style.display="none":t.style.display="block")}:n.style.display="none"}}()}(window,document)</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b6d76ecb62c0651d8e5b7f7085f443f1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-78267963-1","auto"),ga("send","pageview")</script></body></html>